#!groovyâ€‹

node('nodejs') {
    properties([
        disableConcurrentBuilds()
    ])


    stage('checkout') {
        checkout scm
    }

    stage('remove node_modules') {
        sh 'rm -rf node_modules'
    }

    stage('install modules') {
        sh 'yarn install --no-progress'
    }

    stage('build') {
        sh "gulp build"
    }

    stage('test') {
        sh "yarn run test"
    }

    stage('release') {
        sh "gulp release"
    }
}